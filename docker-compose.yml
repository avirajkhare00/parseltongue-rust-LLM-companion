services:
  server:
    build: .
    image: parseltongue:latest
    command: ["pt08-http-code-query-server", "--db", "rocksdb:/data/current/analysis.db", "--port", "7777"]
    ports:
      - "7777:7777"
    volumes:
      - dbdata:/data
    restart: unless-stopped

  mcp:
    build: .
    image: parseltongue:latest
    entrypoint: ["/usr/local/bin/parseltongue-mcp"]
    environment:
      - PARSELTONGUE_BASE_URL=http://server:7777
    depends_on:
      - server

volumes:
  dbdata:
